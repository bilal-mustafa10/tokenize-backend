2024-07-31 06:00:42,429 ERROR: Database error: (psycopg2.errors.NotNullViolation) null value in column "compiler_version" of relation "smart_contract_version" violates not-null constraint
DETAIL:  Failing row contains (22, // SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.8.26;

co..., 2024-07-31 05:00:42.388937, 4, 2024-07-31 05:00:42.38894, Loan Contract, ["The contract should allow a borrower to request a loan of 30 E..., f, # LoanContract Documentation

## Overview
The `LoanContract` is ..., null).

[SQL: INSERT INTO smart_contract_version (smart_contract_id, created_at, updated_at, contract_type, code_requirements, code, documentation, deployed, compiler_version) VALUES (%(smart_contract_id)s, %(created_at)s, %(updated_at)s, %(contract_type)s, %(code_requirements)s, %(code)s, %(documentation)s, %(deployed)s, %(compiler_version)s) RETURNING smart_contract_version.id]
[parameters: {'smart_contract_id': 4, 'created_at': datetime.datetime(2024, 7, 31, 5, 0, 42, 388937), 'updated_at': datetime.datetime(2024, 7, 31, 5, 0, 42, 388940), 'contract_type': 'Loan Contract', 'code_requirements': '["The contract should allow a borrower to request a loan of 30 ETH with a specified interest rate of 5% over a duration of 2 years.","A data structur ... (887 characters truncated) ... he borrower.","The contract should include a function to check the loan status, which should return whether the loan is active, repaid, or overdue."]', 'code': '// SPDX-License-Identifier: GPL-3.0\npragma solidity ^0.8.26;\n\ncontract LoanContract {\n    // State variables to store loan details\n    struct Lo ... (2429 characters truncated) ... else if (loan.isRepaid) {\n            return "Loan has been repaid.";\n        } else {\n            return "Loan is overdue.";\n        }\n    }\n}', 'documentation': "# LoanContract Documentation\n\n## Overview\nThe `LoanContract` is a Solidity smart contract designed to facilitate the management of loans on the Et ... (2467 characters truncated) ... e contract's functionalities, combined with event emissions, provide a transparent and efficient solution for both borrowers and potential investors.", 'deployed': False, 'compiler_version': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/smart_contract/routes.py:136]
2024-07-31 06:03:02,486 INFO: Flask API startup [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/__init__.py:71]
2024-07-31 06:03:31,900 INFO: Flask API startup [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/__init__.py:71]
2024-07-31 06:04:56,244 INFO: Generating smart contract... [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:39]
2024-07-31 06:05:00,270 INFO: classify [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:57]
2024-07-31 06:05:19,269 INFO: generate [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:57]
2024-07-31 06:05:19,448 INFO: check_code [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:57]
2024-07-31 06:05:26,762 INFO: document [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:57]
2024-07-31 06:06:07,215 INFO: Generating smart contract... [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:39]
2024-07-31 06:06:10,260 INFO: classify [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:57]
2024-07-31 06:06:23,353 INFO: generate [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:57]
2024-07-31 06:06:23,500 INFO: check_code [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:57]
2024-07-31 06:06:31,157 INFO: document [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:57]
2024-07-31 06:07:21,979 INFO: Generating smart contract... [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:39]
2024-07-31 06:07:25,765 INFO: classify [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:57]
2024-07-31 06:07:36,976 INFO: Generating smart contract... [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:39]
2024-07-31 06:07:40,373 INFO: classify [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:57]
2024-07-31 06:07:45,520 INFO: generate [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:57]
2024-07-31 06:07:45,625 INFO: check_code [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:57]
2024-07-31 06:08:00,549 INFO: generate [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:57]
2024-07-31 06:08:00,669 INFO: check_code [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:57]
2024-07-31 06:08:08,031 INFO: document [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:57]
2024-07-31 06:10:58,566 INFO: Generating smart contract... [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:39]
2024-07-31 06:11:02,415 INFO: classify [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:57]
2024-07-31 06:11:19,840 INFO: generate [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:57]
2024-07-31 06:11:19,932 INFO: check_code [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:57]
2024-07-31 06:11:24,535 INFO: document [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:57]
2024-07-31 06:24:25,590 INFO: Updating smart contract... [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:93]
2024-07-31 06:24:43,212 INFO: reflect [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:112]
2024-07-31 06:24:43,212 INFO: {"reflect": {"contract": "// SPDX-License-Identifier: GPL-3.0\npragma solidity ^0.8.26;\n\ncontract LoanContract {\n    // State variables\n    address public borrower;\n    address public lender;\n    uint public loanAmount;\n    uint public interestRate;\n    uint public loanStartTime;\n    uint public loanDuration;\n    enum LoanStatus { Active, Paid, Defaulted }\n    LoanStatus public status;\n\n    // Events\n    event LoanInitiated(address indexed borrower, uint amount, uint interestRate);\n    event LoanRepaid(address indexed borrower, uint amount);\n\n    // Constructor to initialize the loan contract\n    constructor(address _borrower) {\n        lender = msg.sender; // The contract deployer is the lender\n        borrower = _borrower;\n        loanAmount = 10 ether; // 10 ETH\n        interestRate = 3; // 3%\n        loanDuration = 365 days; // 1 year\n        status = LoanStatus.Active;\n    }\n\n    // Function to initiate the loan\n    function initiateLoan() external {\n        require(msg.sender == borrower, \"Only the borrower can initiate the loan.\");\n        loanStartTime = block.timestamp;\n        emit LoanInitiated(borrower, loanAmount, interestRate);\n    }\n\n    // Function to calculate total repayment amount after 1 year\n    function calculateTotalRepayment() public view returns (uint) {\n        require(status == LoanStatus.Active, \"Loan is not active.\");\n        uint totalRepayment = loanAmount + (loanAmount * interestRate / 100);\n        return totalRepayment;\n    }\n\n    // Function to repay the loan\n    function repayLoan() external payable {\n        require(msg.sender == borrower, \"Only the borrower can repay the loan.\");\n        require(block.timestamp >= loanStartTime + loanDuration, \"Loan period has not elapsed.\");\n        require(msg.value >= calculateTotalRepayment(), \"Insufficient amount to repay the loan.\");\n\n        // Update loan status\n        status = LoanStatus.Paid;\n        emit LoanRepaid(borrower, msg.value);\n    }\n}", "compiler_version": "0.8.26"}} [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:119]
2024-07-31 06:24:43,406 INFO: check_code [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:112]
2024-07-31 06:24:43,406 INFO: {"check_code": {"error": "no", "error_message": ""}} [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:119]
2024-07-31 06:24:51,395 INFO: document [in /Users/bilal/Documents/comsc/kings/individual-project/Tokenize/backend/app/ai/routes.py:112]
